### 索引
- 可以用于提高读写效率的数据结构很多，三种常见、也比较简单的数据结构，哈希表、有序数组和搜索树。
    - 哈希表这种结构适用于只有等值查询的场景，比如 Memcached 及其他一些 NoSQL 引擎。
    - 有序数组在等值查询和范围查询场景中的性能就都非常优秀
    - 有序数组索引只适用于静态存储引擎
B+ 树： N叉树
#### “N叉树”的N值在MySQL中是可以被人工调整的么？
1. 通过改变key值来调整
N叉树中非叶子节点存放的是索引信息，索引包含Key和Point指针。Point指针固定为6个字节，假如Key为10个字节，那么单个索引就是16个字节。如果B+树中页大小为16K，那么一个页就可以存储1024个索引，此时N就等于1024。我们通过改变Key的大小，就可以改变N的值
2. 改变页的大小
页越大，一页存放的索引就越多，N就越大。
3. 索引信息包括 key：我们的索引字段 + 6字节的Point，这个是point应该是页号。数据页的结构：38字节的File Header + 58字节的Pgae Header + 26字节的伪造最大值与最小值 + 用户record（就是上面的key + point啦）+ Free Space（不确定大小） + Page Directory (不确定大小) + 8字节的 File Trailer


#### 索引维护
- 页新增
- 页分裂
- 页合并
- 主键长度越小，普通索引的叶子节点就越小，普通索引占用的空间也就越小
- 业务字段做主键索引时，只有一个索引；该索引必须是唯一索引；

- 回表：回到主键索引树搜索的过程
- 覆盖索引：在这个查询里面，索引 k 已经“覆盖了”我们的查询需求，我们称为覆盖索引。
    - 由于覆盖索引可以减少树的搜索次数，显著提升查询性能，所以使用覆盖索引是一个常用的性能优化手段。
- 最左前缀原则    
- 索引下推：可以在索引遍历过程中，对索引中包含的字段先做判断，直接过滤掉不满足条件的记录，减少回表次数。

为什么要重建索引：
索引可能因为删除，或者页分裂等原因，导致数据页有空洞，重建索引的过程会创建一个新的索引，把数据按顺序插入，这样页面的利用率最高，也就是索引更紧凑、更省空间。

建表
``` 
mysql> create table T(
id int primary key, 
k int not null, 
name varchar(16),
index (k))engine=InnoDB;
```

重建索引 k
``` 
alter table T drop index k;
alter table T add index(k);
```
重建主键索引
``` 

alter table T drop primary key;
alter table T add primary key(id);
```
- 重建索引 k 的做法是合理的，可以达到省空间的目的。但是，重建主键的过程不合理。不论是删除主键还是创建主键，都会将整个表重建。所以连着执行这两个语句的话，第一个语句就白做了。这两个语句，你可以用这个语句代替 ： alter table T engine=InnoDB。


优点：
1. 索引大大减少了服务器需要扫描的数据量
2. 索引可以帮助服务器避免排序和临时表
3. 索引可以将随机I/O 变为顺序I/O

##### 哈希索引
哈希索引的特点是存储的不是字段key值，而是 key值的 hash值，
且指向的是字段值对应的地址值。
适用场景：当字段值很长时，可以做hash 后将hash 值存储起来新建一个字段索引。  
不使用场景：不适合做范围查询，不适合做匹配查找